
= no-hell-lights

Having fun with lights and micro-controllers.

== Led Strips

=== Material

WS2812 comes in 5v or 12v.

[WARNING]
====
12v are hooked 3 by 3, which means that programmatically there are 3 times less leds.
====

Each led consumes 0.2W max, to be safe count 20W for 60 led, that is 20W per meter.

I use 5v 150W power supply so that 10m 600 led strip is fine.

==== Wiring

Using Arduino Pro Mini 5v as reference.

Wiring for ESP8266 or ESP32 is same as stated below.

As stated in NeoPixel library:

[IMPORTANT]
====
To reduce NeoPixel burnout risk, add 1000 uF capacitor across
pixel power leads, add 300 - 500 Ohm resistor on first pixel's data input
and minimize distance between Arduino and first pixel.  Avoid connecting
on a live circuit...if you must, connect GND first.
====

Then just hook up data pin to one of the pin of arduino.

[NOTE]
====
For 12v strips, make sure not to burn the arduino 5v: don't hook the Vcc !
====


image:res/ws2812-wiring.png[]


=== Sketches

External samples:

* https://github.com/FastLED/FastLED/blob/master/examples/DemoReel100/DemoReel100.ino[Very Good example]

Internal samples:

* link:sketches/arduino/WS2812/Fast-LED-sample1/Fast-LED-sample1.ino[Fast-LED-sample1.ino]


=== APIs

==== Status

[source,bash]
----
$ curl --request GET http://192.168.1.50/status

{
 "system": {
   "heap": 36944,
   "boot-version": 5,
   "cpu-frequency": 160,
   "sdk": "1.5.3(aec24ac9)",
   "chip-id": 2918146,
   "flash-id": 1458400,
   "flash-size": 4194304,
   "vcc": 65535,
   "gpio": 86053
  },
 "message": "status",
 "properties": {
   "power": 1,
   "animation-mode": "single",
   "brightness": 255,
   "autoplay-duration": 10
  },
 "effects": [
   { "id": 0, "name": "RGB Loop" },
   { "id": 1, "name": "Juggle" },
   { "id": 2, "name": "BPM" },
   { "id": 3, "name": "Sinelon" },
   { "id": 4, "name": "Bouncing Balls" },
   { "id": 5, "name": "Bouncing Balls Multiple" },
   { "id": 6, "name": "Candle" },
   { "id": 7, "name": "Fade-in Fade-out" },
   { "id": 8, "name": "Strobe" },
   { "id": 9, "name": "Halloween Eyes" },
   { "id": 10, "name": "Cylon Bounce" },
   { "id": 11, "name": "New KITT" },
   { "id": 12, "name": "Twinkle" },
   { "id": 13, "name": "Twinkle Random" },
   { "id": 14, "name": "Sparkle" },
   { "id": 15, "name": "Sparkle Snow" },
   { "id": 16, "name": "Running Lights" },
   { "id": 17, "name": "Color Wipe" },
   { "id": 18, "name": "Rainbow Cycle" },
   { "id": 19, "name": "Theater Chase" },
   { "id": 20, "name": "Theater Chase Rainbow" },
   { "id": 21, "name": "Meteor Rain", "selected":true },
   { "id": 22, "name": "Fire" },
   { "id": 23, "name": "Confetti" }
  ]
}
----

==== Settings

Sets some settings.
Can be one of:

* animation-mode= autoplay/single/paint

[source,bash]
----
$ curl --request POST  http://192.168.1.50/settings?animation-mode=single
----

==== Set Pixels

[source,bash]
----
$ curl --request POST --data '{ "pixels": [ { "index":1, "color": 0x123456 }, { "index": 2, "color": 0x987654 } ] }' http://192.168.1.50/pixels/set
{
  "pixels": [
    {
      "index": 1,
      "color": 0x123456
    },
    {
      "index": 2,
      "color": 0x987654
    }
  ]
}
----

==== Reset Pixels

[source,bash]
----
$ curl --request POST http://192.168.1.50/pixels/reset
----

== Resources

* https://arduino-esp8266.readthedocs.io/en/latest/

* https://github.com/FastLED/FastLED
* https://github.com/adafruit/Adafruit_NeoPixel[Adafruit_NeoPixel]
* https://www.tweaking4all.com/hardware/arduino/adruino-led-strip-effects/[Examples]

* LUSTREON 50CM Aluminum Channel Holder For LED Strip Light Bar Under Cabinet Lamp

* https://www.instructables.com/id/Wireless-Music-Reactive-Floor-Lamps
* https://github.com/hansjny/Natural-Nerd/tree/master/SoundReactive2
